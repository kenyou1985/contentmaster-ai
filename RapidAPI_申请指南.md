# RapidAPI - YouTube Transcript API 申请指南

## 📋 快速开始（5分钟完成）

### 步骤1：注册 RapidAPI 账号

1. **访问API页面**：
   - 打开：https://rapidapi.com/ugoBas/api/youtube-transcript3
   - 或搜索：`YouTube Transcript API` on RapidAPI

2. **注册账号**：
   - 点击右上角 **"Sign Up"**
   - 可以使用：
     - Google账号（推荐，一键登录）
     - GitHub账号
     - 电子邮件

3. **验证邮箱**（如果使用邮箱注册）：
   - 查收验证邮件
   - 点击链接验证

---

### 步骤2：订阅免费计划

1. **选择计划**：
   - 在API页面，点击 **"Pricing"** 标签
   - 选择 **"Basic"** 计划（免费）
     - 💰 **$0/月**
     - 📊 **1,000 requests/月**
     - ✅ 足够个人使用

2. **订阅**：
   - 点击 **"Subscribe"** 按钮
   - 可能需要添加支付方式（但不会扣费）
   - 确认订阅

---

### 步骤3：获取 API 密钥

1. **查看密钥**：
   - 订阅后，页面会自动显示您的API密钥
   - 或者点击 **"Endpoints"** 标签
   - 在右侧代码示例中找到 `X-RapidAPI-Key`

2. **复制密钥**：
   ```
   您的密钥类似：a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6
   ```
   - 长度：32-64个字符
   - 包含字母和数字

3. **保存密钥**：
   - 复制到安全的地方
   - ⚠️ 不要分享给他人
   - ⚠️ 不要提交到公开的代码仓库

---

### 步骤4：测试 API

1. **在 RapidAPI 网站测试**：
   - 在 **"Endpoints"** 标签
   - 选择 **"Get Transcript"** 端点
   - 填写参数：
     - `videoId`: `dQw4w9WgXcQ`（测试视频）
     - `lang`: `zh,en`（优先中文，其次英文）
   - 点击 **"Test Endpoint"**
   - 查看响应（应该返回字幕数据）

2. **确认成功**：
   - HTTP Status: `200 OK`
   - Response: 包含字幕文本的JSON数据

---

### 步骤5：配置到 Google Apps Script

1. **打开 Google Apps Script**：
   - 访问：https://script.google.com/
   - 找到您的项目

2. **替换代码**：
   - 删除现有代码
   - 复制 `GAS_RapidAPI集成版.gs` 的全部代码
   - 粘贴到编辑器

3. **配置 API 密钥**：
   - 找到第17行：
     ```javascript
     var RAPIDAPI_KEY = 'YOUR_RAPIDAPI_KEY_HERE';
     ```
   - 替换为您的实际密钥：
     ```javascript
     var RAPIDAPI_KEY = 'a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6';
     ```

4. **保存代码**：
   - 点击保存图标（💾）
   - 项目名称：`YouTube字幕提取-RapidAPI版`

---

### 步骤6：测试代码

1. **运行测试函数**：
   - 在顶部下拉菜单选择：`testRapidApi`
   - 点击 **"运行"** 按钮（▶️）
   - 首次运行需要授权：
     - 点击 **"审核权限"**
     - 选择您的Google账号
     - 点击 **"高级"** → **"前往...（不安全）"**
     - 点击 **"允许"**

2. **查看日志**：
   - 点击 **"查看"** → **"日志"**
   - 或点击顶部的日志图标
   - 应该看到：
     ```
     ========== 测试视频 1 ==========
     Video ID: dQw4w9WgXcQ
     ✅✅✅ 成功！
     长度: 1234
     前100字: We're no strangers to love...
     ```

3. **确认成功**：
   - 至少有1个视频测试成功
   - 字幕内容正确

---

### 步骤7：重新部署

1. **更新部署**：
   - 点击 **"部署"** → **"管理部署"**
   - 点击现有部署右侧的 **"编辑"** 图标（铅笔）
   - 将 **"版本"** 改为 **"新版本"**
   - 确认 **"执行身份"** 是 **"我"**
   - 确认 **"有权访问该应用的用户"** 是 **"任何人"**
   - 点击 **"部署"**

2. **复制 URL**：
   - URL不会变化
   - 可以继续使用之前的URL

---

### 步骤8：测试前端

1. **刷新浏览器**：
   - 按 `Ctrl + Shift + R`（强制刷新）

2. **测试提取**：
   - 粘贴YouTube链接：`https://www.youtube.com/watch?v=dQw4w9WgXcQ`
   - 点击 **"提取字幕"** 按钮
   - 等待几秒
   - 字幕应该自动填入输入框 ✅

3. **查看开发者工具**（F12 → Console）：
   - 应该看到：
     ```
     [YouTubeService] 字幕提取成功，长度: 1234字
     ```

---

## 📊 配额说明

**免费计划（Basic）**：
- 💰 **$0/月**
- 📊 **1,000 requests/月**
- ⏱️ **每秒1次请求**

**计算**：
- 每次提取 = 1 request
- 1,000次/月 ≈ 每天33次
- 适合个人使用

**升级计划**：
如果配额不足，可以升级：
- **Pro**: $9.99/月，10,000 requests
- **Ultra**: $29.99/月，100,000 requests
- **Mega**: $99.99/月，1,000,000 requests

**查看使用情况**：
- 访问：https://rapidapi.com/developer/dashboard
- 查看当月已使用的请求数

---

## ⚠️ 注意事项

1. **API密钥安全**：
   - ❌ 不要分享给他人
   - ❌ 不要提交到GitHub等公开平台
   - ✅ 只保存在Google Apps Script中（服务器端）

2. **配额管理**：
   - 避免无限循环调用
   - 监控每月使用量
   - 必要时实现缓存机制

3. **错误处理**：
   - API可能返回403（配额用完）
   - API可能返回404（视频无字幕）
   - 前端已有适当的错误处理

---

## 🎉 完成确认

确认您已完成：
- [ ] 注册了 RapidAPI 账号
- [ ] 订阅了免费计划（Basic）
- [ ] 获取并复制了 API 密钥
- [ ] 在RapidAPI网站测试成功
- [ ] 配置了Google Apps Script代码
- [ ] 运行测试函数成功
- [ ] 重新部署了应用
- [ ] 前端测试提取字幕成功

**🎊 恭喜！YouTube字幕自动提取功能已上线！**

---

## 🆘 常见问题

### Q: 测试失败，返回403错误？
A: 检查API密钥是否正确配置，是否还有剩余配额。

### Q: 返回404错误？
A: 该视频可能没有字幕，或者视频ID错误。

### Q: 配额用完了怎么办？
A: 等到下个月重置，或升级到付费计划。

### Q: API密钥在哪里配置？
A: 只在Google Apps Script中配置（服务器端），前端不需要配置。

### Q: 安全吗？
A: ✅ 密钥在服务器端，前端看不到。✅ 符合RapidAPI使用条款。

---

## 📞 需要帮助？

如果遇到问题，请提供：
1. 错误截图（前端和GAS日志）
2. API密钥前10位（用于确认格式）
3. 测试的视频ID

我会帮您解决！😊
