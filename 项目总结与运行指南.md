# ContentMaster AI - 项目总结与运行指南

## 📁 项目目录结构

```
contentmaster-ai/
├── App.tsx                 # 主应用组件，管理 API Key 和标签页切换
├── index.tsx               # React 应用入口文件
├── index.html              # HTML 模板
├── vite.config.ts          # Vite 构建配置
├── tsconfig.json           # TypeScript 配置
├── package.json            # 项目依赖和脚本
├── constants.ts            # 所有 Prompt 模板和配置常量（核心文件）
├── types.ts                # TypeScript 类型定义
├── metadata.json           # 项目元数据
├── README.md               # 项目说明文档
│
├── components/             # React 组件目录
│   ├── Layout.tsx         # 布局组件（包含 API Key 设置）
│   ├── Generator.tsx      # 内容生成器主组件
│   ├── NicheSelector.tsx  # 领域选择器组件
│   └── Tools.tsx          # 工具页面组件（改写、扩展、总结、润色）
│
└── services/              # 服务层目录
    └── geminiService.ts   # Gemini API 服务封装
```

## 🎯 项目功能概述

这是一个基于 **React + TypeScript + Vite** 的 AI 内容生成工具，使用 **Google Gemini API** 生成各种类型的内容。

### 核心功能模块

1. **中醫玄學 (Ni Hai Xia)** - 倪海廈风格内容
   - 時辰禁忌：擇日與物理
   - 情色因果：桃花與孽緣
   - 面相解密：富貴與貧賤
   - 科學風水：磁場與環境
   - 中醫闢謠：經方與西醫

2. **金融投資 (Munger)** - 查理·芒格风格内容
   - 宏觀預警：大國博弈
   - 認知誤判：人類心理學
   - 逆向思維：如何失敗
   - 價值投資：護城河
   - 人生智慧：富有是附屬品

3. **復仇故事 (Storytelling)** - 跨文化故事引擎
   - 文化驅動原創 (Mode 2)
   - 改編與本地化 (Mode 1)

4. **爆款文案 (Viral)** - 通用爆款风格

5. **工具功能**
   - 改写 (REWRITE)
   - 扩展 (EXPAND)
   - 总结 (SUMMARIZE)
   - 润色 (POLISH)

## 🛠️ 技术栈

- **前端框架**: React 18.3.1
- **构建工具**: Vite 6.2.0
- **语言**: TypeScript 5.8.2
- **AI SDK**: @google/genai (最新版)
- **UI 库**: 
  - Tailwind CSS (通过 CDN)
  - Lucide React (图标库)
- **工具库**: JSZip (用于文件压缩)

## 📋 运行前准备

### 1. 系统要求
- **Node.js**: 需要安装 Node.js (推荐 v18 或更高版本)
- **npm**: 通常随 Node.js 一起安装

### 2. 检查 Node.js 安装
在终端运行以下命令检查：
```bash
node --version
npm --version
```

如果没有安装，请访问 [Node.js 官网](https://nodejs.org/) 下载安装。

## 🚀 本地运行步骤

### 步骤 1: 安装依赖

在项目根目录打开终端，运行：

```bash
npm install
```

这将安装所有必需的依赖包，包括：
- react, react-dom
- @google/genai
- lucide-react
- jszip
- vite 及相关开发工具

### 步骤 2: 配置 API Key（可选）

项目支持两种方式设置 Gemini API Key：

#### 方式 1: 通过环境变量（推荐）

在项目根目录创建 `.env.local` 文件：

```env
VITE_GEMINI_API_KEY=你的_Gemini_API_Key
VITE_GEMINI_BASE_URL=https://api.yunwu.ai  # 可选，如果使用云雾 AI 等代理服务
```

**注意**: 
- 如果 API Key 以 `sk-` 开头，系统会自动使用云雾 AI 的 Base URL
- 如果不设置环境变量，可以在应用界面中直接输入 API Key

#### 方式 2: 在应用界面中输入

启动应用后，在界面顶部可以输入 API Key，系统会自动保存到 localStorage。

### 步骤 3: 启动开发服务器

运行以下命令：

```bash
npm run dev
```

服务器将在 `http://localhost:3000` 启动（根据 vite.config.ts 配置）。

### 步骤 4: 访问应用

打开浏览器，访问：
```
http://localhost:3000
```

## 📝 可用命令

```bash
# 启动开发服务器
npm run dev

# 构建生产版本
npm run build

# 预览生产构建
npm run preview
```

## 🔧 项目配置说明

### Vite 配置 (vite.config.ts)
- **端口**: 3000
- **主机**: 0.0.0.0 (允许外部访问)
- **环境变量**: 自动加载 `.env.local` 中的 `GEMINI_API_KEY` 和 `GEMINI_BASE_URL`

### TypeScript 配置 (tsconfig.json)
- 目标: ES2022
- JSX: react-jsx
- 模块解析: bundler
- 路径别名: `@/*` 映射到项目根目录

## 🌐 API 服务说明

### Gemini Service (services/geminiService.ts)

**主要功能**:
- `initializeGemini(apiKey, baseUrl)`: 初始化 Gemini API 客户端
- `generateTopics(prompt, systemInstruction, modelName)`: 生成主题列表
- `streamContentGeneration(prompt, systemInstruction, onChunk, modelName)`: 流式生成内容

**特性**:
- 自动重试机制（针对 429、500、503 等错误）
- 支持自定义 Base URL（用于代理服务）
- 自动检测云雾 AI Key（以 `sk-` 开头）

**默认模型**: `gemini-2.0-flash-exp`

## 📦 项目特点

1. **纯前端应用**: 无需后端服务器
2. **环境变量支持**: 可通过 `.env.local` 配置
3. **本地存储**: API Key 保存在 localStorage
4. **流式输出**: 支持实时显示生成内容
5. **多语言支持**: 支持中文、英文、日文、西班牙文、印地语
6. **暗色主题**: 默认使用暗色主题 UI

## ⚠️ 注意事项

1. **API Key 安全**: 
   - 不要将 `.env.local` 文件提交到 Git
   - 如果使用 Git，确保 `.env.local` 在 `.gitignore` 中

2. **API 限制**:
   - 注意 Gemini API 的调用频率限制
   - 项目已实现自动重试机制处理限流

3. **网络要求**:
   - 需要能够访问 Google Gemini API 或代理服务
   - 如果在中国大陆，可能需要使用代理服务（如云雾 AI）

## 🐛 常见问题

### 问题 1: npm install 失败
**解决方案**: 
- 检查网络连接
- 尝试使用国内镜像：`npm config set registry https://registry.npmmirror.com`
- 或使用 `cnpm` 或 `yarn`

### 问题 2: 端口 3000 已被占用
**解决方案**: 
- 修改 `vite.config.ts` 中的 `port` 配置
- 或关闭占用端口的程序

### 问题 3: API 调用失败
**解决方案**:
- 检查 API Key 是否正确
- 检查网络连接
- 如果使用代理服务，检查 Base URL 是否正确
- 查看浏览器控制台的错误信息

### 问题 4: 依赖安装后仍有类型错误
**解决方案**:
- 运行 `npm install` 确保所有依赖已安装
- 检查 `node_modules` 目录是否存在
- 尝试删除 `node_modules` 和 `package-lock.json`，然后重新安装

## 📚 相关资源

- [Vite 文档](https://vitejs.dev/)
- [React 文档](https://react.dev/)
- [Google Gemini API](https://ai.google.dev/)
- [TypeScript 文档](https://www.typescriptlang.org/)

---

**祝您使用愉快！** 🎉
